{"version":3,"sources":["./src/app/pages/systemMonitor/systemMonitor.component.ts","./src/app/pages/systemMonitor/systemMonitor.component.html","./src/app/pages/systemMonitor/systemMonitor-routing.module.ts","./src/app/pages/systemMonitor/systemMonitor.module.ts"],"names":[],"mappings":"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","file":"pages-systemMonitor-systemMonitor-module.js","sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { timer } from 'rxjs';\n\nimport { Metric } from './Metric';\n\nimport * as Highcharts from 'highcharts';\nimport theme from 'highcharts/themes/dark-unica';\ntheme(Highcharts);\n\n@Component({\n  selector: 'app-systemMonitor',\n  templateUrl: './systemMonitor.component.html',\n  styleUrls: ['./systemMonitor.component.css']\n})\nexport class SystemMonitorComponent implements OnInit {\n\n  Highcharts: typeof Highcharts = Highcharts;\n\n  mem_chart: any;\n  mem_chartCallback: any;\n  mem_chartOptions: Highcharts.Options = {\n    chart: {\n      type: 'spline',\n    },\n    time: {\n      useUTC: false,\n    },\n    title: {\n      \"text\": '内存使用监控'\n    },\n    xAxis: {\n      type: 'datetime',\n      dateTimeLabelFormats: {\n        day: '%m-%d',\n      },\n      labels: {\n        overflow: 'justify',\n      },\n    },\n    yAxis: {\n      allowDecimals: false,\n      title: {\n        text: \"容量(M)\"\n      }\n    },\n    tooltip: {\n      headerFormat: '<b>{point.x:%Y-%m-%d %H:%M:%S}</b><br>',\n      pointFormat: '{point.y:.2f}',\n    },\n    plotOptions: {\n      spline: {\n        marker: {\n          enabled: true\n        }\n      }\n    },\n    series: [{\n      type: 'spline',\n      name: \"Eden Space\",\n      data: []\n    },\n    {\n      type: 'spline',\n      name: \"Survivor Space\",\n      data: []\n    },\n    {\n      type: 'spline',\n      name: \"Old Gen\",\n      data: []\n    }]\n  };\n\n  cpu_chart: any;\n  cpu_chartCallback: any;\n  cpu_chartOptions: Highcharts.Options = {\n    chart: {\n      type: 'spline',\n    },\n    time: {\n      useUTC: false,\n    },\n    title: {\n      \"text\": 'CPU使用监控'\n    },\n    xAxis: {\n      type: 'datetime',\n      dateTimeLabelFormats: {\n        day: '%m-%d',\n      },\n      labels: {\n        overflow: 'justify',\n      },\n    },\n    yAxis: {\n      allowDecimals: false,\n      title: {\n        text: \"百分比(%)\"\n      }\n    },\n    tooltip: {\n      headerFormat: '<b>{point.x:%Y-%m-%d %H:%M:%S}</b><br>',\n      pointFormat: '{point.y:.2f}',\n    },\n    plotOptions: {\n      spline: {\n        marker: {\n          enabled: true\n        }\n      }\n    },\n    series: [{\n      type: 'spline',\n      name: \"系统\",\n      data: []\n    },\n    {\n      type: 'spline',\n      name: \"业务\",\n      data: []\n    }]\n  };\n\n  constructor(private httpClient: HttpClient) {\n    const self = this;\n    this.mem_chartCallback = (chart: Highcharts.Chart) => {\n      self.mem_chart = chart;\n    }\n\n    this.cpu_chartCallback = (chart: Highcharts.Chart) => {\n      self.cpu_chart = chart;\n    }\n  }\n\n  ngOnInit() {\n\n    const source = timer(1000, 30 * 1000);\n    const subscribe = source.subscribe(val => this.getMessage());\n  }\n\n  getMessage() {\n    let url = '/monitor';\n    this.httpClient.get(url).subscribe((data: any) => {\n      let metrics: Metric[] = data;\n      metrics.forEach(metric => {\n        if (metric.name === 'jvm.memory.used') {\n          if (metric.tags['id'].endsWith('Eden Space')) {\n            this.mem_chart.series[0].addPoint(metric.datapoints[0], true, false);\n          } else if (metric.tags['id'].endsWith('Survivor Space')) {\n            this.mem_chart.series[1].addPoint(metric.datapoints[0], true, false);\n          } else if (metric.tags['id'].endsWith('Old Gen')) {\n            this.mem_chart.series[2].addPoint(metric.datapoints[0], true, false);\n          }\n        } else if (metric.name === 'system.cpu.usage') {\n          this.cpu_chart.series[0].addPoint(metric.datapoints[0], true, false);\n        } else if (metric.name === 'process.cpu.usage') {\n          this.cpu_chart.series[1].addPoint(metric.datapoints[0], true, false);\n        }\n      });\n    });\n  }\n\n}\n","<div nz-row>\n    <div nz-col nzSpan=\"24\">\n        <highcharts-chart [Highcharts]=\"Highcharts\" [options]=\"cpu_chartOptions\"\n            [callbackFunction]=\"cpu_chartCallback\" [oneToOne]=\"true\" style=\"width: 100%; height: 400px; display: block;\"></highcharts-chart>\n    </div>\n</div>\n<div nz-row style=\"margin-top: 20px;\">\n    <div nz-col nzSpan=\"24\">\n        <highcharts-chart [Highcharts]=\"Highcharts\" [options]=\"mem_chartOptions\"\n            [callbackFunction]=\"mem_chartCallback\" [oneToOne]=\"true\" style=\"width: 100%; height: 400px; display: block;\"></highcharts-chart>\n    </div>\n</div>\n","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\nimport { SystemMonitorComponent } from './systemMonitor.component';\n\nconst routes: Routes = [\n  { path: '', component: SystemMonitorComponent },\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule]\n})\nexport class SystemMonitorRoutingModule { }\n","import { NgModule } from '@angular/core';\n\nimport { SystemMonitorRoutingModule } from './systemMonitor-routing.module';\n\nimport { SystemMonitorComponent } from './systemMonitor.component';\nimport { HighchartsChartModule } from 'highcharts-angular';\n\n@NgModule({\n  imports: [\n    SystemMonitorRoutingModule,\n    HighchartsChartModule\n  ],\n  declarations: [SystemMonitorComponent],\n  exports: [SystemMonitorComponent]\n})\nexport class SystemMonitorModule { }\n"],"sourceRoot":"webpack:///"}